<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="icon" type="image/x-icon" href="/public/img/favicon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
    <link rel="manifest" href="/assets/img/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/assets/img/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/assets/img/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="/public/css/bootstrap.min.css" />

    <link rel="stylesheet" href="/public/css/lnr-icon.css" />

    <link rel="stylesheet" href="/public/css/font-awesome.min.css" />

    <link rel="stylesheet" href="/public/plugins/select2/select2.min.css" />

    <link rel="stylesheet" href="/public/css/style.css" />
    <title>LEAVE</title>

</head>

<body>
    <div class="inner-wrapper">
        <!--  header partials  -->
        <%- include('partials/headerEmployee'); %>

            <div class="page-wrapper">
                <div class="container-fluid">
                    <div class="row">
                        <!--  side bar aside tag -->
                        <%- include('partials/asideEmployee'); %>

                            <div class="col-xl-10 col-lg-9 col-md-12">

                                <% if(warning !='' ){ %>
                                    <div class="grow">
                                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                                        <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
                                            <path
                                                d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                                        </symbol>
                                    </svg>
                                    <div class="alert alert-warning d-flex align-items-center" role="alert">
                                        <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img"
                                            aria-label="Warning:">
                                            <use xlink:href="#exclamation-triangle-fill" />
                                        </svg>
                                        <div>
                                            <%= warning %>
                                        </div>
                                    </div>
                                </div>

                                    <% } if(success !='' ){ %>
                                        <div class="grow">
                                        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                                            <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
                                                <path
                                                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                                            </symbol>

                                        </svg>
                                        <div class="alert alert-success d-flex align-items-center" role="alert">
                                            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img"
                                                aria-label="Success:">
                                                <use xlink:href="#check-circle-fill" />
                                            </svg>
                                            <div>
                                                <%= success %>
                                            </div>
                                        </div>
                                    </div> 
                                        <% } %>


                                            <div class="card shadow-sm grow ctm-border-radius">
                                                <div class="card-body align-center">
                                                    <h4 class="card-title float-left mb-0 mt-2">Leave Details</h4>
                                                    <br></br>

                                                    <ul class="nav nav-tabs float-right border-0 tab-list-emp">

                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="card shadow-sm grow ctm-border-radius">
                                                <div class="card-body align-right">
                                                    <div class="input-group">
                                                        <select class="form-control" id="size">
                                                            <option value="6">6</option>
                                                            <option value="12" selected>12</option>
                                                            <option value="24">24</option>
                                                            <option value="51">51</option>
                                                        </select>
                                                        <input type="number" class="form-control"
                                                            placeholder="page number" min="1" id="page">
                                                        <div class="input-group-append">
                                                            <button class="btn btn-theme text-white ctm-border-radius"
                                                                id="search" type="button" onclick="myFunction();">
                                                                Search
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="card shadow-sm grow ctm-border-radius">
                                                <div class="card-body d-flex justify-content-between">
                                                    <a class="btn btn-theme button-1 text-white ctm-border-radius add-person ctm-btn-padding"
                                                        onclick="addLeaveFun()">
                                                        <i class="fa fa-angles-left"></i>&nbsp;Add Leave
                                                    </a>
                                                    <a class="btn btn-theme button-1 text-white ctm-border-radius add-person ctm-btn-padding"
                                                        onclick="history.back()">
                                                        Back&nbsp;<i class="fa fa-angles-right"></i>
                                                    </a>
                                                </div>
                                            </div>

                                            <% function formatDate(dateObject) { let d=new Date(dateObject); let
                                                day=d.getDate(); let month=d.getMonth() + 1; let year=d.getFullYear();
                                                if (day < 10) { day="0" + day; } if (month < 10) { month="0" + month; }
                                                let date=year + "-" + month + "-" + day; return date; }; %>
                                                <div class="ctm-border-radius shadow-sm grow card">
                                                    <div class="card-body">

                                                        <div class="row people-grid-row" id="displayLeaveDetails">
                                                            <% if(!leavesdata.length) { %>
                                                                <div class='col-12 text-center'>
                                                                    <p>
                                                                    <h4 class='text-danger'>Nothing to show !!!</h4>
                                                                    </p>
                                                                </div>

                                                                <% } else{ leavesdata.forEach(leavedata=> { %>
                                                                    <div class="col-md-6 col-lg-6 col-xl-4">
                                                                        <div class="card widget-profile">
                                                                            <div class="card-body">
                                                                                <div class="pro-widget-content">
                                                                                    <div class="profile-info-widget">
                                                                                        <p><label
                                                                                                class="form-label text-orange lead">Start
                                                                                                Date :</label>
                                                                                            <span class="text-primary">
                                                                                                <a class="text-primary">
                                                                                                    <%= formatDate(leavedata.startDate)
                                                                                                        %>
                                                                                                </a></span>
                                                                                        </p>
                                                                                        <p><label
                                                                                                class="form-label text-orange lead">End
                                                                                                Date :</label>
                                                                                            <span class="text-primary">
                                                                                                <a class="text-primary">
                                                                                                    <%= formatDate(leavedata.endDate)
                                                                                                        %>
                                                                                                </a></span>
                                                                                        </p>
                                                                                        <p><label
                                                                                                class="form-label text-orange lead">Reason
                                                                                                :</label>


                                                                                            <span class="text-primary">

                                                                                                <%= leavedata.reason %>
                                                                                            </span>
                                                                                        </p>
                                                                                        <h4>
                                                                                            <p
                                                                                                class="float-right text-danger cursor-pointer">
                                                                                                <a href="/leave/view/<%= leavedata.id %>"
                                                                                                    class="btn btn-theme text-white ctm-border-radius">VIEW</a>
                                                                                            </p>
                                                                                        </h4>

                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <% }) }%>


                                                        </div>
                                                    </div>
                                                </div>
                            </div>
                    </div>
                </div>
            </div>
    </div>
    </div>
    <div class="sidebar-overlay" id="sidebar_overlay"></div>

    <script src="/public/js/jquery-3.2.1.min.js"></script>

    <script src="/public/js/popper.min.js"></script>
    <script src="/public/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/additional-methods.min.js"></script>

    <script src="/public/plugins/theia-sticky-sidebar/ResizeSensor.js"></script>
    <script src="/public/plugins/theia-sticky-sidebar/theia-sticky-sidebar.js"></script>

    <script src="/public/plugins/select2/moment.min.js"></script>
    <script src="/public/js/bootstrap-datetimepicker.min.js"></script>

    <script src="/public/plugins/select2/select2.min.js"></script>

    <script src="/public/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>

    <script src="/public/js/script.js"></script>
    <script src="/public/js/navigation.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"
        integrity="sha512-37T7leoNS06R80c8Ulq7cdCDU5MNQBwlYoy1TX/WUsLFC2eYNqtKlV0QjH7r8JpG/S0GUMZwebnVFLPd6SU5yg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.js"></script>

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>

    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>

    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>
    <script>
        $('.aside-module-name').text('Leaves');
        $('#asideLeave').removeClass('text-dark').addClass('active').addClass('text-white');

    </script>
    <script>
        function myFunction() {
            let size = document.getElementById("size").value;
            let pageX = document.getElementById("page").value;
            let page;
            if (!Number.isNaN(pageX) && pageX > 0) {
                page = pageX;
            } else {
                page = 1;
            }
            page = page - 1;
            let query = `page=${page}&size=${size}`;
            window.location.href = `/leave/view?${query}`;
            //             $.ajax({
            //                 url: `/leave/view-search?${query}`,
            //                 method: 'get',
            //                 success: function (result) {
            //                     $('#displayLeaveDetails').html('');
            //                     result.data.forEach(leave => {
            //                         let dummyStartDate = formatDate(leave.startDate);
            //                         let dummyEndDate = formatDate(leave.endDate);
            //                         $('#displayLeaveDetails').append(`                                                                            
            //                     <div class="col-md-6 col-lg-6 col-xl-4">
            //                                                     <div class="card widget-profile">
            //                                                         <div class="card-body">
            //                                                             <div class="pro-widget-content">
            //                                                                 <div class="profile-info-widget">
            // <p><label
            // class="form-label text-orange lead">Start
            // Date :</label>
            // <span class="text-primary">
            // <a class="text-primary">${dummyStartDate}
            // </a></span>
            // </p>
            // <p><label
            // class="form-label text-orange lead">End
            // Date :</label>
            // <span class="text-primary">
            // <a class="text-primary">
            //      ${dummyEndDate}
            // </a></span>
            // </p>
            // <p><label
            // class="form-label text-orange lead">Reason
            // :</label>
            // <span class="text-primary">
            // ${leave.reason}
            // </span>
            // </p>
            // <h4>
            //         <p class="float-right text-danger cursor-pointer">
            //          <a href="/leave/view/${leave.id}" class="btn btn-secondary" >VIEW</a></p></h4>
            //                                                                 </div>
            //                                                             </div>
            //                                                         </div>
            //                                                     </div>
            //                                                 </div>
            //                     `);
            //                     });
            //                 },
            //                 error: function (error) {
            //                     console.log(error);
            //                 }
            //             }).done((res) => {
            //                 console.log(res);
            //             });
        }

        function addLeaveFun() {
            window.location.href = `/leave/add-view`;
        }
    </script>

</body>

</html>